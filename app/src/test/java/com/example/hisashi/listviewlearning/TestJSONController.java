package com.example.hisashi.listviewlearning;

import junit.framework.Assert;

import org.json.JSONException;
import org.junit.Test;

import java.util.ArrayList;

/**
 * Created by hisashi on 2015-10-28.
 */
public class TestJSONController {
    private final String simpleJsonString = "{\"age\":100,\"name\":\"mkyong.com\",\"messages\":[\"msg 1\",\"msg 2\",\"msg 3\"]}";
    private final String mattersJsonString = "{\"matters\":[{\"id\":1021016254,\"client\":{\"id\":874150830,\"url\":\"/api/v2/contacts/874150830\",\"name\":\"Clio LLC\"},\"display_number\":\"00001-Clio LLC\",\"description\":\"Protective Order\",\"status\":\"Open\",\"open_date\":\"2013-12-13\",\"close_date\":null,\"pending_date\":null,\"location\":\"\",\"client_reference\":\"\",\"responsible_attorney\":null,\"originating_attorney\":null,\"practice_area\":null,\"billable\":true,\"maildrop_address\":\"c0edfcb1f+matter1021016254@maildrop.goclio.com\",\"created_at\":\"2013-12-13T18:10:30+00:00\",\"updated_at\":\"2013-12-13T18:10:30+00:00\",\"custom_field_values\":[],\"billing_method\":\"hourly\",\"group_id\":378442,\"permission\":{\"id\":378442,\"url\":\"/api/v2/groups/378442\",\"name\":\"Firm\"},\"activity_rates\":[{\"id\":1885440,\"created_at\":\"2014-06-12T19:03:18+00:00\",\"updated_at\":\"2014-06-12T19:03:18+00:00\",\"user\":{\"id\":344214492,\"url\":\"/api/v2/users/344214492\",\"name\":\"Mobile Project\",\"email\":\"mobileproject@goclio.com\"},\"group\":null,\"rate\":0.0,\"flat_rate\":false,\"activity_description\":null}]},{\"id\":1021016262,\"client\":{\"id\":874150842,\"url\":\"/api/v2/contacts/874150842\",\"name\":\"Jason Peebles\"},\"display_number\":\"00002-Peebles\",\"description\":\"Contract Drafting\",\"status\":\"Open\",\"open_date\":\"2013-12-13\",\"close_date\":null,\"pending_date\":null,\"location\":\"\",\"client_reference\":\"\",\"responsible_attorney\":null,\"originating_attorney\":null,\"practice_area\":null,\"billable\":true,\"maildrop_address\":\"c0edfcb1f+matter1021016262@maildrop.goclio.com\",\"created_at\":\"2013-12-13T18:11:21+00:00\",\"updated_at\":\"2013-12-13T18:11:21+00:00\",\"custom_field_values\":[{\"id\":40592,\"type\":\"CustomFieldNumericValue\",\"custom_field\":{\"id\":110934,\"url\":\"/api/v2/custom_fields/110934\",\"name\":\"Estimated days\"},\"created_at\":\"2013-12-17T16:29:48+00:00\",\"updated_at\":\"2013-12-17T16:52:59+00:00\",\"value\":10}],\"billing_method\":\"hourly\",\"group_id\":378442,\"permission\":{\"id\":378442,\"url\":\"/api/v2/groups/378442\",\"name\":\"Firm\"},\"activity_rates\":[{\"id\":1916482,\"created_at\":\"2014-06-25T00:55:48+00:00\",\"updated_at\":\"2014-06-25T00:55:48+00:00\",\"user\":{\"id\":344214492,\"url\":\"/api/v2/users/344214492\",\"name\":\"Mobile Project\",\"email\":\"mobileproject@goclio.com\"},\"group\":null,\"rate\":0.0,\"flat_rate\":false,\"activity_description\":null}]},{\"id\":1021016274,\"client\":{\"id\":874150854,\"url\":\"/api/v2/contacts/874150854\",\"name\":\"Apple Inc.\"},\"display_number\":\"00003-Apple Inc.\",\"description\":\"Client Collections\",\"status\":\"Open\",\"open_date\":\"2013-12-13\",\"close_date\":null,\"pending_date\":null,\"location\":\"\",\"client_reference\":\"\",\"responsible_attorney\":null,\"originating_attorney\":null,\"practice_area\":null,\"billable\":true,\"maildrop_address\":\"c0edfcb1f+matter1021016274@maildrop.goclio.com\",\"created_at\":\"2013-12-13T18:11:49+00:00\",\"updated_at\":\"2013-12-13T18:11:49+00:00\",\"custom_field_values\":[],\"billing_method\":\"hourly\",\"group_id\":378442,\"permission\":{\"id\":378442,\"url\":\"/api/v2/groups/378442\",\"name\":\"Firm\"},\"activity_rates\":[{\"id\":1916494,\"created_at\":\"2014-06-25T00:58:12+00:00\",\"updated_at\":\"2014-06-25T00:58:12+00:00\",\"user\":{\"id\":344214492,\"url\":\"/api/v2/users/344214492\",\"name\":\"Mobile Project\",\"email\":\"mobileproject@goclio.com\"},\"group\":null,\"rate\":0.0,\"flat_rate\":false,\"activity_description\":null}]},{\"id\":1021016280,\"client\":{\"id\":874150830,\"url\":\"/api/v2/contacts/874150830\",\"name\":\"Clio LLC\"},\"display_number\":\"00004-Clio LLC\",\"description\":\"Hiring project\",\"status\":\"Open\",\"open_date\":\"2013-12-13\",\"close_date\":null,\"pending_date\":null,\"location\":\"\",\"client_reference\":\"\",\"responsible_attorney\":null,\"originating_attorney\":null,\"practice_area\":null,\"billable\":true,\"maildrop_address\":\"c0edfcb1f+matter1021016280@maildrop.goclio.com\",\"created_at\":\"2013-12-13T18:12:05+00:00\",\"updated_at\":\"2013-12-13T18:12:05+00:00\",\"custom_field_values\":[],\"billing_method\":\"hourly\",\"group_id\":378442,\"permission\":{\"id\":378442,\"url\":\"/api/v2/groups/378442\",\"name\":\"Firm\"},\"activity_rates\":[{\"id\":1917634,\"created_at\":\"2014-06-25T16:30:10+00:00\",\"updated_at\":\"2014-06-25T16:30:10+00:00\",\"user\":{\"id\":344214492,\"url\":\"/api/v2/users/344214492\",\"name\":\"Mobile Project\",\"email\":\"mobileproject@goclio.com\"},\"group\":null,\"rate\":0.0,\"flat_rate\":false,\"activity_description\":null}]},{\"id\":1021016282,\"client\":{\"id\":874150854,\"url\":\"/api/v2/contacts/874150854\",\"name\":\"Apple Inc.\"},\"display_number\":\"00005-Apple Inc.\",\"description\":\"iOS App\",\"status\":\"Open\",\"open_date\":\"2013-12-13\",\"close_date\":null,\"pending_date\":null,\"location\":\"\",\"client_reference\":\"\",\"responsible_attorney\":null,\"originating_attorney\":null,\"practice_area\":null,\"billable\":true,\"maildrop_address\":\"c0edfcb1f+matter1021016282@maildrop.goclio.com\",\"created_at\":\"2013-12-13T18:12:26+00:00\",\"updated_at\":\"2013-12-13T18:12:26+00:00\",\"custom_field_values\":[{\"id\":40602,\"type\":\"CustomFieldNumericValue\",\"custom_field\":{\"id\":110934,\"url\":\"/api/v2/custom_fields/110934\",\"name\":\"Estimated days\"},\"created_at\":\"2013-12-17T16:53:43+00:00\",\"updated_at\":\"2013-12-17T16:55:09+00:00\",\"value\":12}],\"billing_method\":\"hourly\",\"group_id\":378442,\"permission\":{\"id\":378442,\"url\":\"/api/v2/groups/378442\",\"name\":\"Firm\"},\"activity_rates\":[{\"id\":1917632,\"created_at\":\"2014-06-25T16:29:45+00:00\",\"updated_at\":\"2014-06-25T16:29:45+00:00\",\"user\":{\"id\":344214492,\"url\":\"/api/v2/users/344214492\",\"name\":\"Mobile Project\",\"email\":\"mobileproject@goclio.com\"},\"group\":null,\"rate\":0.0,\"flat_rate\":false,\"activity_description\":null}]},{\"id\":1022329802,\"client\":{\"id\":874150854,\"url\":\"/api/v2/contacts/874150854\",\"name\":\"Apple Inc.\"},\"display_number\":\"00006-Apple Inc.\",\"description\":\"Test matter\",\"status\":\"Pending\",\"open_date\":null,\"close_date\":null,\"pending_date\":\"2015-02-20\",\"location\":\"\",\"client_reference\":\"\",\"responsible_attorney\":null,\"originating_attorney\":null,\"practice_area\":null,\"billable\":true,\"maildrop_address\":\"c0edfcb1f+matter1022329802@maildrop.goclio.com\",\"created_at\":\"2014-03-07T00:09:10+00:00\",\"updated_at\":\"2015-02-20T21:15:16+00:00\",\"custom_field_values\":[],\"billing_method\":\"hourly\",\"group_id\":378442,\"permission\":{\"id\":378442,\"url\":\"/api/v2/groups/378442\",\"name\":\"Firm\"},\"activity_rates\":[]},{\"id\":1022329814,\"client\":{\"id\":874150842,\"url\":\"/api/v2/contacts/874150842\",\"name\":\"Jason Peebles\"},\"display_number\":\"00007-Peebles\",\"description\":\"This is a matter\",\"status\":\"Open\",\"open_date\":\"2014-03-07\",\"close_date\":null,\"pending_date\":null,\"location\":\"\",\"client_reference\":\"\",\"responsible_attorney\":null,\"originating_attorney\":null,\"practice_area\":null,\"billable\":true,\"maildrop_address\":\"c0edfcb1f+matter1022329814@maildrop.goclio.com\",\"created_at\":\"2014-03-07T00:09:59+00:00\",\"updated_at\":\"2014-03-07T00:09:59+00:00\",\"custom_field_values\":[],\"billing_method\":\"hourly\",\"group_id\":378442,\"permission\":{\"id\":378442,\"url\":\"/api/v2/groups/378442\",\"name\":\"Firm\"},\"activity_rates\":[]},{\"id\":1023381955,\"client\":{\"id\":874150854,\"url\":\"/api/v2/contacts/874150854\",\"name\":\"Apple Inc.\"},\"display_number\":\"00008-Apple Inc.\",\"description\":\"iPhone 7\",\"status\":\"Closed\",\"open_date\":\"2014-05-21\",\"close_date\":\"2015-02-20\",\"pending_date\":null,\"location\":\"\",\"client_reference\":\"\",\"responsible_attorney\":null,\"originating_attorney\":null,\"practice_area\":null,\"billable\":true,\"maildrop_address\":\"c0edfcb1f+matter1023381955@maildrop.goclio.com\",\"created_at\":\"2014-05-21T20:43:21+00:00\",\"updated_at\":\"2015-02-20T21:14:50+00:00\",\"custom_field_values\":[],\"billing_method\":\"hourly\",\"group_id\":378442,\"permission\":{\"id\":378442,\"url\":\"/api/v2/groups/378442\",\"name\":\"Firm\"},\"activity_rates\":[{\"id\":1917644,\"created_at\":\"2014-06-25T16:30:31+00:00\",\"updated_at\":\"2014-06-25T16:30:31+00:00\",\"user\":{\"id\":344214492,\"url\":\"/api/v2/users/344214492\",\"name\":\"Mobile Project\",\"email\":\"mobileproject@goclio.com\"},\"group\":null,\"rate\":0.0,\"flat_rate\":false,\"activity_description\":null}]}],\"records\":8,\"limit\":200,\"next_offset\":1023381955,\"order_dir\":\"asc\",\"total_records\":8,\"published_at\":\"2015-10-28T21:02:19+00:00\"}";

    @Test
    public void testParseSimpleJson() throws JSONException {
        JSONParser.parseSimpleJson(simpleJsonString);
    }

    @Test
    public void testParseMattersJson() throws JSONException {
        ArrayList<Record> expectedRecords = new ArrayList<>();
        expectedRecords.add(new Record("Clio LLC", "00001-Clio LLC", "Protective Order", "2013-12-13", "Open"));
        expectedRecords.add(new Record("Jason Peebles", "00002-Peebles", "Contract Drafting", "2013-12-13", "Open"));
        expectedRecords.add(new Record("Apple Inc.", "00003-Apple Inc.", "Client Collections", "2013-12-13", "Open"));
        expectedRecords.add(new Record("Clio LLC", "00004-Clio LLC", "Hiring project", "2013-12-13", "Open"));
        expectedRecords.add(new Record("Apple Inc.", "00005-Apple Inc.", "iOS App", "2013-12-13", "Open"));
        expectedRecords.add(new Record("Apple Inc.", "00006-Apple Inc.", "Test matter", "", "Pending"));
        expectedRecords.add(new Record("Jason Peebles", "00007-Peebles", "This is a matter", "2014-03-07", "Open"));
        expectedRecords.add(new Record("Apple Inc.", "00008-Apple Inc.", "iPhone 7", "2014-05-21", "Closed"));

        ArrayList<Record> actualRecords = JSONParser.parseMatterJson(mattersJsonString);
        Assert.assertTrue(expectedRecords.equals(actualRecords));
    }
}
